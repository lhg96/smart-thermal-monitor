# Hardware Design - 하드웨어 설계 문서

Zoombo 프로젝트의 하드웨어 설계 및 회로 구성에 대한 상세 문서입니다.

## 🔧 주요 하드웨어 구성

### 메인 컨트롤러
- **MCU**: ESP32-WROOM-32
- **프로세서**: Dual-core Xtensa 32-bit LX6 @ 240MHz  
- **메모리**: 520KB SRAM, 4MB Flash
- **무선**: WiFi 802.11 b/g/n, Bluetooth 4.2

### 센서 모듈 목록

| 센서 | 모델명 | 용도 | 인터페이스 | 전원 |
|------|--------|------|------------|------|
| 적외선 온도센서 | MLX90615 | 비접촉 체온 측정 | I2C | 3.3V |
| 온습도 센서 | DHT22 | 환경 온습도 측정 | Digital | 3.3V-5V |
| 거리 센서 | VL53L0X | 레이저 거리 측정 | I2C | 3.3V |
| PIR 모션 센서 | HC-SR602 | 인체 감지 | Digital | 3.3V |
| 레이더 센서 | RCWL-0516 | 마이크로파 모션 감지 | Digital | 3.3V |
| RGB LED | WS2812B | 상태 표시 | Digital | 5V |
| 터치 센서 | Capacitive | 사용자 입력 | Analog | 3.3V |
| 레이저 포인터 | - | 포지셔닝 | Digital | 3.3V |

## 🔌 핀 맵핑 및 연결도

### ESP32 GPIO 할당

```
GPIO Pin   │ 센서/모듈         │ 신호 타입    │ 용도
──────────┼─────────────────┼────────────┼─────────────
GPIO 21    │ SDA (I2C)       │ Digital    │ I2C 데이터
GPIO 22    │ SCL (I2C)       │ Digital    │ I2C 클럭
GPIO 14    │ DHT22           │ Digital    │ 온습도 센서
GPIO 2     │ WS2812B         │ Digital    │ RGB LED
GPIO 4     │ SR602 (PIR)     │ Digital    │ PIR 모션
GPIO 5     │ RCWL0516        │ Digital    │ 레이더 모션
GPIO 18    │ Laser Pointer   │ Digital    │ 레이저 제어
GPIO 19    │ Touch Sensor    │ Analog     │ 터치 입력
GND        │ Common Ground   │ Power      │ 접지
3.3V       │ Sensor Power    │ Power      │ 센서 전원
5V         │ LED Power       │ Power      │ LED 전원
```

### I2C 버스 연결

```
ESP32 I2C Bus
├── MLX90615 (Address: 0x5B)
│   ├── VDD → 3.3V
│   ├── VSS → GND  
│   ├── SDA → GPIO 21
│   └── SCL → GPIO 22
└── VL53L0X (Address: 0x29)
    ├── VDD → 3.3V
    ├── GND → GND
    ├── SDA → GPIO 21
    └── SCL → GPIO 22
```

## ⚡ 전원 설계

### 전력 소모 분석

| 구성요소 | 동작 전압 | 소모 전류 | 전력 |
|----------|-----------|-----------|------|
| ESP32 | 3.3V | 160-260mA | 0.53-0.86W |
| MLX90615 | 3.3V | 1.4mA | 0.005W |
| DHT22 | 3.3V | 1-1.5mA | 0.003-0.005W |
| VL53L0X | 3.3V | 10mA | 0.033W |
| SR602 | 3.3V | <50µA | <0.0002W |
| RCWL0516 | 3.3V | 2-3mA | 0.007-0.010W |
| WS2812B | 5V | 60mA/LED | 0.3W (1개) |
| 합계 | - | ~240mA | ~0.9W |

### 전원 공급 방식

```
USB 5V Input
    │
    ├── Linear Regulator (AMS1117-3.3) → 3.3V Rail
    │   │
    │   ├── ESP32 Core
    │   ├── MLX90615
    │   ├── DHT22  
    │   ├── VL53L0X
    │   ├── SR602
    │   ├── RCWL0516
    │   └── Touch Sensor
    │
    └── 5V Rail
        └── WS2812B LED
```

## 🏗️ 회로도

### 메인 회로 구성

```
                    ESP32-WROOM-32
                   ┌─────────────────┐
                   │                 │
     3.3V ────────┤ 3V3             │
     GND ─────────┤ GND         D21 ├──── SDA (I2C)
                  │             D22 ├──── SCL (I2C)  
     DHT22 ──────┤ D14         D2  ├──── WS2812B
     SR602 ──────┤ D4          D5  ├──── RCWL0516
     Touch ──────┤ D19         D18 ├──── Laser
                  │                 │
                  └─────────────────┘
```

### I2C 센서 연결

```
MLX90615 온도센서              VL53L0X 거리센서
┌─────────────┐               ┌─────────────┐
│ VDD    SDA  │               │ VDD    SDA  │
│ VSS    SCL  │               │ GND    SCL  │
└─────────────┘               └─────────────┘
     │    │                       │    │
     │    └───────────┬───────────┘    │
     │                │                │
     └────────────────┼────────────────┘
                      │
                 I2C Bus (ESP32)
                 SDA (GPIO21)
                 SCL (GPIO22)
```

## 📦 PCB 레이아웃 (권장)

### 레이어 구성 (2-Layer PCB)

**Top Layer (구성요소 배치)**
```
    [ESP32]     [MLX90615]
      │             │
    [DHT22]     [VL53L0X]
      │             │  
   [SR602]      [RCWL0516]
      │             │
  [Touch]       [WS2812B]
      │             │
   [Laser]      [커넥터]
```

**Bottom Layer (GND Plane)**
- 전체 접지면으로 구성
- 신호 무결성 향상
- EMI 차폐 효과

### 배치 고려사항

1. **센서 간격**: 서로 간섭하지 않도록 충분한 간격 유지
2. **열 관리**: 발열 소자(ESP32) 주변에 방열 공간 확보
3. **신호 라우팅**: I2C 라인의 길이 최소화
4. **전원 분배**: 3.3V와 5V 라인 분리
5. **안테나 영역**: ESP32 WiFi 안테나 주변 메탈 제거

## 🔩 기구 설계

### 케이스 요구사항

- **재질**: ABS 플라스틱 또는 아크릴
- **크기**: 100mm × 80mm × 30mm (예상)
- **방열**: ESP32 모듈 위치에 방열 슬롯
- **센서 노출**: MLX90615, VL53L0X를 위한 개구부
- **LED 투광**: WS2812B LED를 위한 투명/반투명 부분
- **커넥터**: USB 전원 및 프로그래밍 포트

### 센서 배치 최적화

```
케이스 전면 (사용자 대면)
┌─────────────────────────┐
│  ◯ MLX90615 (온도)      │ ← 체온 측정을 위해 전면 배치
│                         │
│  ◯ VL53L0X (거리)       │ ← 거리 측정을 위해 전면 배치  
│                         │
│  ● WS2812B (상태LED)    │ ← 상태 표시용
│                         │
│         [Touch]         │ ← 사용자 인터랙션
└─────────────────────────┘

케이스 측면
│ [USB Port] │ ← 전원 및 프로그래밍
```

## 📐 기계적 사양

### 치수 및 중량
- **케이스 외형**: 100 × 80 × 30 mm
- **PCB 크기**: 90 × 70 mm  
- **총 중량**: 약 150g (배터리 제외)
- **동작 온도**: -10°C ~ +50°C
- **보관 온도**: -20°C ~ +70°C
- **습도**: 10% ~ 90% RH (비응축)

### 내구성
- **낙하 테스트**: 1m 높이에서 낙하 견딤
- **진동**: 2G @ 10-500Hz 견딤
- **IP 등급**: IP20 (먼지 보호)

## 🔧 조립 가이드

### 필요 도구
- 납땜 인두 (온도 조절 가능)
- 납땜선 (0.8mm)
- 멀티미터
- 점퍼 와이어
- 브레드보드 (프로토타입용)

### 조립 순서

1. **PCB 검증**: 전원 라인 단락 여부 확인
2. **ESP32 납땜**: 메인 컨트롤러 먼저 장착
3. **전원 회로**: 3.3V 레귤레이터 및 필터 캐패시터
4. **I2C 센서**: MLX90615, VL53L0X 순서로 장착
5. **디지털 센서**: DHT22, SR602, RCWL0516
6. **LED 모듈**: WS2812B RGB LED
7. **기타**: 터치 센서, 레이저 포인터
8. **연결 테스트**: 각 센서별 동작 확인
9. **케이스 조립**: PCB를 케이스에 고정
10. **최종 테스트**: 전체 시스템 동작 확인

### 테스트 체크리스트

- [ ] 전원 전압 확인 (3.3V, 5V)
- [ ] I2C 통신 정상 동작
- [ ] 각 센서 데이터 읽기 성공  
- [ ] WiFi 연결 및 데이터 전송
- [ ] LED 동작 및 터치 센서 반응
- [ ] 전체 시스템 연동 테스트

## 🛠️ 문제 해결

### 일반적인 하드웨어 문제

1. **센서 인식 불가**
   - I2C 풀업 저항 확인 (4.7kΩ)
   - 전원 전압 측정 (3.3V ±5%)
   - 배선 연결 상태 점검

2. **WiFi 연결 불안정**
   - 안테나 주변 금속 제거
   - 전원 공급 안정성 확인
   - PCB 그라운드 플레인 점검

3. **센서 데이터 노이즈**
   - 전원 필터링 강화
   - 센서별 개별 전원 공급
   - 디지털/아날로그 그라운드 분리

### 개선 방향

- **고성능 센서**: 더 정확한 온도/거리 센서로 업그레이드
- **저전력 설계**: Sleep 모드 및 전력 관리 IC 적용  
- **무선 충전**: Qi 무선 충전 모듈 추가
- **방수 설계**: IP65 등급의 방수 케이스 적용