# System Architecture - ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

Zoombo í”„ë¡œì íŠ¸ì˜ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ìƒì„¸ ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Zoombo IoT System                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WiFi     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Hardware      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   IoT Platform  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   Cloud Server  â”‚
â”‚   (ESP32)       â”‚             â”‚  (ThingsPark)   â”‚             â”‚ (App Engine)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚                               â”‚
         â”‚ Sensor Data                   â”‚ REST API                     â”‚ REST API
         â–¼                               â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Multiple Sensorsâ”‚             â”‚  Data Storage   â”‚             â”‚  Mobile App     â”‚
â”‚ â€¢ Temperature   â”‚             â”‚  â€¢ Time Series  â”‚             â”‚  (Tizen)       â”‚
â”‚ â€¢ Motion        â”‚             â”‚  â€¢ Realtime     â”‚             â”‚                 â”‚
â”‚ â€¢ Distance      â”‚             â”‚  â€¢ Analytics    â”‚             â”‚                 â”‚
â”‚ â€¢ Touch/LED     â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ê³„ì¸µë³„ êµ¬ì¡°

### 1. Hardware Layer (í•˜ë“œì›¨ì–´ ê³„ì¸µ)

**ESP32 ê¸°ë°˜ ì„¼ì„œ ì‹œìŠ¤í…œ**
```
ESP32-WROOM-32
â”œâ”€â”€ Digital Pins
â”‚   â”œâ”€â”€ GPIO 14: DHT22 (ì˜¨ìŠµë„)
â”‚   â”œâ”€â”€ GPIO 21: SDA (I2C)
â”‚   â”œâ”€â”€ GPIO 22: SCL (I2C)
â”‚   â””â”€â”€ GPIO 2: WS2812B (RGB LED)
â”œâ”€â”€ Analog Pins
â”‚   â””â”€â”€ ADC: Touch Sensor
â””â”€â”€ Communication
    â”œâ”€â”€ WiFi 802.11 b/g/n
    â””â”€â”€ I2C Bus
```

**ì„¼ì„œ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€**
```
    ESP32 (Master Controller)
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ I2C Bus â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚        â”‚        â”‚        â”‚
MLX90615  VL53L0X   DHT22   SR602   RCWL0516
(ì˜¨ë„)    (ê±°ë¦¬)   (ì˜¨ìŠµë„) (PIR)   (ë ˆì´ë”)
```

### 2. Firmware Layer (íŒì›¨ì–´ ê³„ì¸µ)

**ëª¨ë“ˆì‹ ì•„í‚¤í…ì²˜**
```cpp
// ë©”ì¸ ì œì–´ ë£¨í”„
void loop() {
    timer.run(); // SimpleTimer ê¸°ë°˜ ìŠ¤ì¼€ì¤„ë§
}

// ì„¼ì„œë³„ ëª¨ë“ˆ
â”œâ”€â”€ mlx90615.ino    // ì˜¨ë„ ì„¼ì„œ ì œì–´
â”œâ”€â”€ dht22.ino       // ì˜¨ìŠµë„ ì„¼ì„œ ì œì–´  
â”œâ”€â”€ vl53.ino        // ê±°ë¦¬ ì„¼ì„œ ì œì–´
â”œâ”€â”€ SR602.ino       // PIR ëª¨ì…˜ ì„¼ì„œ
â”œâ”€â”€ rcwl0516.ino    // ë ˆì´ë” ì„¼ì„œ
â”œâ”€â”€ AP.ino          // WiFi í†µì‹ 
â”œâ”€â”€ laser.ino       // ë ˆì´ì € í¬ì¸í„°
â”œâ”€â”€ Touch.ino       // í„°ì¹˜ ì„¼ì„œ
â””â”€â”€ ws2812b.ino     // RGB LED
```

### 3. Communication Layer (í†µì‹  ê³„ì¸µ)

**WiFi í”„ë¡œí† ì½œ ìŠ¤íƒ**
```
Application Layer    â”‚ HTTP GET/POST
Transport Layer      â”‚ TCP
Network Layer        â”‚ IP
Data Link Layer      â”‚ WiFi 802.11
Physical Layer       â”‚ 2.4GHz Radio
```

**ë°ì´í„° íŒ¨í‚· êµ¬ì¡°**
```
GET /channels/entrys?apiKey={key}&field1={temp}&field2={obj}&field3={dist}

Headers:
- Host: api.thingspark.kr
- User-Agent: ESP8266/1.0
- Connection: close

Response:
- HTTP/1.1 200 OK
- Content-Type: application/json
```

### 4. IoT Platform Layer (IoT í”Œë«í¼ ê³„ì¸µ)

**ThingsPark ì•„í‚¤í…ì²˜**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Gateway   â”‚ â† ESP32 HTTP ìš”ì²­
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Ingestion â”‚ â† ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Time Series DB â”‚ â† ì‹œê³„ì—´ ë°ì´í„° ì €ì¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  REST API       â”‚ â† App Engine ìš”ì²­
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì±„ë„ ìŠ¤í‚¤ë§ˆ**
```json
{
  "channel_id": 65703,
  "fields": {
    "field1": "í™˜ê²½ì˜¨ë„ (Â°C)",
    "field2": "ë¬¼ì²´ì˜¨ë„ (Â°C)", 
    "field3": "ê±°ë¦¬ (mm)"
  },
  "metadata": {
    "created_at": "timestamp",
    "location": "optional"
  }
}
```

### 5. Cloud Server Layer (í´ë¼ìš°ë“œ ì„œë²„ ê³„ì¸µ)

**Google App Engine ì•„í‚¤í…ì²˜**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Load Balancer â”‚ â† HTTP ìš”ì²­ ë¶„ì‚°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Java Runtime   â”‚ â† JAX-RS ì• í”Œë¦¬ì¼€ì´ì…˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Servlet Engine â”‚ â† ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Logging/Monitorâ”‚ â† Stackdriver
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**API ë ˆì´ì–´ êµ¬ì¡°**
```java
@Path("/thermal")
public class ThermalAPI {
    @GET
    @Path("/last")
    public String getEnvTemp() {
        // ThingsPark API í˜¸ì¶œ
        // JSON íŒŒì‹±
        // ì‘ë‹µ í˜•ì‹ ë³€í™˜
        return "temp1/temp2/distance/timestamp";
    }
}
```

### 6. Mobile Application Layer (ëª¨ë°”ì¼ ì•± ê³„ì¸µ)

**Xamarin.Forms ì•„í‚¤í…ì²˜**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Layer      â”‚ â† XAML Views
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Logic Layer   â”‚ â† C# Code-behind
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   HTTP Client   â”‚ â† System.Net.Http
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   JSON Parser   â”‚ â† Newtonsoft.Json
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Tizen Runtime â”‚ â† Native Platform
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ë°ì´í„° í”Œë¡œìš°

### ì‹¤ì‹œê°„ ë°ì´í„° í”Œë¡œìš°
```
1. Sensor Reading â†’ ESP32 Buffer â†’ WiFi Transmission
2. ThingsPark Ingestion â†’ Time Series Storage
3. App Engine Request â†’ ThingsPark API â†’ JSON Response
4. Mobile App Parse â†’ UI Update â†’ User Display
```

### ë°ì´í„° ë³€í™˜ ê³¼ì •
```cpp
// ESP32: Raw sensor data
float temperature = mlx.get_object_temp();
float distance = vl53.readRangeSingleMillimeters();

// HTTP transmission
String url = "/channels/entrys?field1=" + String(envTemp) + 
             "&field2=" + String(objTemp) + 
             "&field3=" + String(distance);

// ThingsPark storage
{
  "field1": "25.5",
  "field2": "36.8", 
  "field3": "150",
  "created_at": "2020-09-05T10:05:49.000Z"
}

// App Engine response
"25.5/36.8/150/2020-09-05T10:05:49"

// Mobile app display
envTemp2.Text = "25.5Â°C";
objTemp2.Text = "36.8Â°C";
distance2.Text = "150mm";
```

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ìµœì í™”
```cpp
// ë¹„ë™ê¸° ì„¼ì„œ ì½ê¸°
timer.setInterval(1000L, readMLX);     // ì˜¨ë„: 1ì´ˆ
timer.setInterval(1000L, readVL53);    // ê±°ë¦¬: 1ì´ˆ  
timer.setInterval(3000L, readDHT22);   // ì˜¨ìŠµë„: 3ì´ˆ
timer.setInterval(100L, runTouch);     // í„°ì¹˜: 0.1ì´ˆ
```

### ë„¤íŠ¸ì›Œí¬ ìµœì í™”
```cpp
// ì„ íƒì  ì „ì†¡ (ì „ë ¥ ì ˆì•½)
void sendWiFiData(){  
  if(pirState == HIGH) { // ì¸ì²´ ê°ì§€ ì‹œì—ë§Œ ì „ì†¡
    // WiFi ë°ì´í„° ì „ì†¡
  }
}
```

### í´ë¼ìš°ë“œ ìµœì í™”
- **ìë™ ìŠ¤ì¼€ì¼ë§**: App Engine ìë™ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- **ìºì‹±**: HTTP ì‘ë‹µ ìºì‹±ìœ¼ë¡œ ì§€ì—°ì‹œê°„ ë‹¨ì¶•
- **ì••ì¶•**: gzip ì••ì¶•ìœ¼ë¡œ ëŒ€ì—­í­ ì ˆì•½

## ğŸ”’ ë³´ì•ˆ ì•„í‚¤í…ì²˜

### í†µì‹  ë³´ì•ˆ
```
ESP32 â†â”€[HTTPS]â”€â†’ ThingsPark â†â”€[HTTPS]â”€â†’ App Engine â†â”€[HTTPS]â”€â†’ Mobile App
```

### ì¸ì¦ ì²´ê³„
- **API Key ê¸°ë°˜**: ThingsPark API í‚¤ ì¸ì¦
- **HTTPS ê°•ì œ**: ëª¨ë“  í†µì‹  ì•”í˜¸í™”
- **ì…ë ¥ ê²€ì¦**: ì„œë²„ì¸¡ ë°ì´í„° ê²€ì¦

## ğŸš€ í™•ì¥ì„± ì„¤ê³„

### ìˆ˜í‰ì  í™•ì¥
- **ë‹¤ì¤‘ ì„¼ì„œ ë…¸ë“œ**: ì—¬ëŸ¬ ESP32 ë””ë°”ì´ìŠ¤ ì§€ì›
- **ë¡œë“œ ë°¸ëŸ°ì‹±**: App Engine ìë™ ë¡œë“œ ë°¸ëŸ°ì‹±
- **ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬

### ìˆ˜ì§ì  í™•ì¥  
- **ê³ ì„±ëŠ¥ ì„¼ì„œ**: ë” ì •í™•í•œ ì„¼ì„œë¡œ ì—…ê·¸ë ˆì´ë“œ
- **ê³ ì† í”„ë¡œì„¸ì„œ**: ESP32-S3 ë“±ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ
- **í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤**: App Engine ì¸ìŠ¤í„´ìŠ¤ ì—…ê·¸ë ˆì´ë“œ

ì´ ì•„í‚¤í…ì²˜ëŠ” IoT ì‹œìŠ¤í…œì˜ í™•ì¥ì„±, ì•ˆì •ì„±, ì„±ëŠ¥ì„ ê³ ë ¤í•˜ì—¬ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, í–¥í›„ AI/ML ê¸°ëŠ¥ ì¶”ê°€ ë° ìƒìš©í™”ë¥¼ ìœ„í•œ ê¸°ë°˜ì„ ì œê³µí•©ë‹ˆë‹¤.